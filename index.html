<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lacko Menu</title>
<style>
html,body{margin:0;padding:0;height:100%;overflow:hidden;background:transparent;
font-family:"Segoe UI",Roboto,Arial,sans-serif;color:#eaf1ff;}
#overlay{position:fixed;right:40px;top:50%;transform:translateY(-50%);z-index:1000;}
.menu{width:360px;background:rgba(15,23,42,0.55);backdrop-filter:blur(18px);
border-radius:14px;border:1px solid rgba(120,150,255,0.25);
box-shadow:0 8px 24px rgba(0,0,0,0.35);overflow:hidden;display:flex;flex-direction:column;}
.menu-header{background:linear-gradient(90deg,#3b82f6,#1e3a8a);padding:14px 0;text-align:center;
font-size:22px;font-weight:600;color:#fff;text-shadow:0 0 8px rgba(0,0,0,.4);}
.menu-list{padding:10px 16px;flex:1;}
.menu-list.hidden{display:none;}
.menu-item{background:rgba(255,255,255,0.07);border-radius:10px;padding:10px 14px;margin:6px 0;
display:flex;justify-content:space-between;align-items:center;font-size:16px;transition:.15s;}
.menu-item.selected{background:rgba(59,130,246,0.32);
box-shadow:-3px 0 10px rgba(59,130,246,0.35);}
.toggle{width:34px;height:18px;border-radius:20px;background:rgba(255,255,255,0.25);
position:relative;transition:.25s;cursor:pointer;}
.toggle::before{content:"";position:absolute;top:2px;left:2px;width:14px;height:14px;
border-radius:50%;background:white;transition:.25s;}
.toggle.active{background:#3b82f6;}
.toggle.active::before{transform:translateX(16px);}
.menu-footer{border-top:1px solid rgba(255,255,255,0.07);padding:8px 14px;
font-size:12px;color:rgba(255,255,255,0.6);display:flex;justify-content:space-between;}
</style>
</head>
<body>
<div id="overlay">
  <div class="menu">
    <div class="menu-header" id="menuTitle">Control Panel</div>

    <div class="menu-list" id="mainMenu">
      <div class="menu-item" data-type="page" data-open="self">Self Options ›</div>
    </div>

    <div class="menu-list hidden" id="menu-self">
      <div class="menu-item" data-type="toggle" data-id="noclip">Noclip <div class="toggle"></div></div>
      <div class="menu-item" data-type="toggle" data-id="godmode">Godmode <div class="toggle"></div></div>
    </div>

    <div class="menu-footer"><div>UI v2.0</div><div>© 2025</div></div>
  </div>
</div>

<script>
(function(){
  const title = document.getElementById('menuTitle');
  const main = document.getElementById('mainMenu');
  const selfBox = document.getElementById('menu-self');

  let page = "main";
  let index = 0;

  function setPage(name){
    page = name;
    if(name==="main"){
      main.classList.remove('hidden');
      selfBox.classList.add('hidden');
      title.textContent = "Control Panel";
    }else if(name==="self"){
      main.classList.add('hidden');
      selfBox.classList.remove('hidden');
      title.textContent = "Self Options";
    }
  }

  function setIndex(p, idx){
    const list = p==="main" ? main : selfBox;
    [...main.querySelectorAll('.menu-item'), ...selfBox.querySelectorAll('.menu-item')]
      .forEach(el=>el.classList.remove('selected'));
    const items = list.querySelectorAll('.menu-item');
    if(items[idx]) items[idx].classList.add('selected');
  }

  function applyStates(states){
    for(const id in states){
      const el = document.querySelector(`[data-id="${id}"] .toggle`);
      if(el) el.classList.toggle('active', !!states[id]);
    }
  }

  // called from Lua
  window.addEventListener('message',e=>{
    const d=e.data; if(!d)return;
    if(d.action==='setPage') setPage(d.page);
    else if(d.action==='setIndex') setIndex(d.page,d.index);
    else if(d.action==='updateState') applyStates(d.states||{});
  });

  // when toggles clicked, send to KeyserHttpPost endpoint
  document.querySelectorAll('.toggle').forEach(t=>{
    t.addEventListener('click',()=>{
      const id = t.parentElement.getAttribute('data-id');
      const newState = !t.classList.contains('active');
      t.classList.toggle('active', newState);
      const body = JSON.stringify({option:id, enabled:newState});
      // This line triggers Keyser's local Lua handler:
      KeyserHttpPost("http://menuAction", body);
    });
  });
})();
</script>
</body>
</html>
